{
  "manifestVersion": "1.0.0",
  "name": "MediaShot",
  "version": "1.1.0",
  "displayName": "多媒体截取工具",
  "description": "一个强大的多媒体处理插件，支持视频片段截取、音频片段截取、图像区域截取和编辑等功能。支持中文字体、智能线条粗细、箭头绘制和批量编辑。",
  "author": "VCP Team",
  "pluginType": "synchronous",
  "entryPoint": {
    "type": "python",
    "command": "python media_shot.py"
  },
  "communication": {
    "protocol": "stdio",
    "timeout": 60000
  },
  "configSchema": {
    "OUTPUT_QUALITY": {
      "type": "integer",
      "description": "输出图片质量 (1-100)",
      "default": 90
    },
    "OUTPUT_FORMAT": {
      "type": "string",
      "description": "输出图片格式 (jpg, png)",
      "default": "jpg"
    },
    "DEFAULT_FONT_SIZE": {
      "type": "integer",
      "description": "默认字体大小",
      "default": 20
    },
    "DEFAULT_STROKE_WIDTH": {
      "type": "integer",
      "description": "默认线条宽度",
      "default": 2
    }
  },
  "capabilities": {
    "invocationCommands": [
      {
        "commandIdentifier": "CaptureFrame",
        "description": "从视频中捕获指定时间点的帧截图。\n参数:\n- videoPath (字符串, 必需): 视频文件的完整路径\n- timestampMs (整数, 必需): 截图的时间点（毫秒）\n- outputPath (字符串, 可选): 输出文件路径\n- quality (整数, 可选): 图片质量 (1-100)\n- format (字符串, 可选): 输出格式 (jpg, png)\n\n调用格式:\n<<<[TOOL_REQUEST]>>>\ntool_name:「始」MediaShot「末」,\ncommand:「始」CaptureFrame「末」,\nvideoPath:「始」/path/to/video.mp4「末」,\ntimestampMs:「始」5000「末」\n<<<[END_TOOL_REQUEST]>>>"
      },
      {
        "commandIdentifier": "ExtractVideoClip",
        "description": "从视频中截取指定时间段的片段。\n参数:\n- videoPath (字符串, 必需): 视频文件的完整路径\n- startMs (整数, 必需): 开始时间（毫秒）\n- endMs (整数, 必需): 结束时间（毫秒），如果超过视频长度将自动调整\n- outputPath (字符串, 可选): 输出文件路径\n- quality (字符串, 可选): 输出质量 (low, medium, high)，默认medium\n\n调用格式:\n<<<[TOOL_REQUEST]>>>\ntool_name:「始」MediaShot「末」,\ncommand:「始」ExtractVideoClip「末」,\nvideoPath:「始」/path/to/video.mp4「末」,\nstartMs:「始」10000「末」,\nendMs:「始」30000「末」\n<<<[END_TOOL_REQUEST]>>>"
      },
      {
        "commandIdentifier": "ExtractAudioClip",
        "description": "从音频或视频文件中截取指定时间段的音频片段。\n参数:\n- audioPath (字符串, 必需): 音频或视频文件的完整路径\n- startMs (整数, 必需): 开始时间（毫秒）\n- endMs (整数, 必需): 结束时间（毫秒），如果超过音频长度将自动调整\n- outputPath (字符串, 可选): 输出文件路径\n- format (字符串, 可选): 输出格式 (mp3, wav, aac)，默认mp3\n\n调用格式:\n<<<[TOOL_REQUEST]>>>\ntool_name:「始」MediaShot「末」,\ncommand:「始」ExtractAudioClip「末」,\naudioPath:「始」/path/to/audio.mp3「末」,\nstartMs:「始」10000「末」,\nendMs:「始」30000「末」\n<<<[END_TOOL_REQUEST]>>>"
      },
      {
        "commandIdentifier": "CropImage",
        "description": "截取图片的指定区域（按比例参数）。\n参数:\n- imagePath (字符串, 必需): 图片文件的完整路径\n- x (浮点数, 必需): 左上角X坐标比例 (0.0-1.0)\n- y (浮点数, 必需): 左上角Y坐标比例 (0.0-1.0)\n- width (浮点数, 必需): 宽度比例 (0.0-1.0)\n- height (浮点数, 必需): 高度比例 (0.0-1.0)\n- outputPath (字符串, 可选): 输出文件路径\n\n调用格式:\n<<<[TOOL_REQUEST]>>>\ntool_name:「始」MediaShot「末」,\ncommand:「始」CropImage「末」,\nimagePath:「始」/path/to/image.jpg「末」,\nx:「始」0.1「末」,\ny:「始」0.1「末」,\nwidth:「始」0.8「末」,\nheight:「始」0.8「末」\n<<<[END_TOOL_REQUEST]>>>"
      },
      {
        "commandIdentifier": "EditImage",
        "description": "在图片指定区域绘制框、圆、箭头或添加文字注释，以及应用特效（按比例参数）。\n\n**支持的编辑类型:**\n- rectangle: 绘制矩形框\n- circle: 绘制圆形框\n- text: 添加文字注释\n- arrow: 绘制箭头\n- resolution_reduction: 分辨率下降特效\n- grayscale: 黑白特效\n- crop_region: 截取指定区域\n\n参数:\n- imagePath (字符串, 必需): 图片文件的完整路径\n- editType (字符串, 必需): 编辑类型\n- x (浮点数, 特定类型必需): 区域X坐标比例 (0.0-1.0)\n- y (浮点数, 特定类型必需): 区域Y坐标比例 (0.0-1.0)\n- width (浮点数, rectangle/crop_region时必需): 宽度比例 (0.0-1.0)\n- height (浮点数, rectangle/crop_region时必需): 高度比例 (0.0-1.0)\n- radius (浮点数, circle时必需): 半径比例 (0.0-1.0)\n- text (字符串, text时必需): 要添加的文字\n- scaleRatio (浮点数, resolution_reduction时必需): 分辨率缩放比例 (0.1-1.0)\n- color (字符串, 可选): 颜色名称或16进制值 (red, #FF0000等)，默认red\n- fontSize (浮点数, 可选): 字体大小比例 (0.0-1.0)，取值范围0.01-0.2，例如0.05表示字体大小为图片较小边的5%\n- strokeWidth (浮点数, 可选): 线条宽度比例 (0.0-1.0)，取值范围0.001-0.01，例如0.002表示线条宽度为图片对角线的0.2%\n- textPosition (字符串, 可选): 文字位置 (top_left, top_center, top_right, center_left, center, center_right, bottom_left, bottom_center, bottom_right)，默认center\n- arrowEndX (浮点数, arrow时必需): 箭头终点X坐标比例\n- arrowEndY (浮点数, arrow时必需): 箭头终点Y坐标比例\n- outputPath (字符串, 可选): 输出文件路径\n\n**比例值参数使用说明**：\n1. fontSize参数：传递0.0-1.0的比例值，推荐取值0.02-0.1，插件会根据图片尺寸自动计算实际像素大小\n2. strokeWidth参数：传递0.0-1.0的比例值，推荐取值0.001-0.005，插件会根据图片对角线长度自动计算线条粗细\n3. 坐标和尺寸参数(x,y,width,height,radius)：均为0.0-1.0的比例值，0.0表示左上角/最小值，1.0表示右下角/最大值\n4. 输出文件遵循严格命名规则：原图片名 + 操作类型 + 唯一时间戳\n\n调用格式:\n<<<[TOOL_REQUEST]>>>\ntool_name:「始」MediaShot「末」,\ncommand:「始」EditImage「末」,\nimagePath:「始」/path/to/image.jpg「末」,\neditType:「始」text「末」,\nx:「始」0.5「末」,\ny:「始」0.5「末」,\ntext:「始」你好世界「末」,\ncolor:「始」#FF0000「末」,\nfontSize:「始」0.05「末」\n<<<[END_TOOL_REQUEST]>>>"
      },
      {
        "commandIdentifier": "BatchEditImage",
        "description": "批量编辑图片：逐步应用多个编辑操作（按顺序执行）。\n\n**支持的编辑类型:**\n- rectangle: 绘制矩形框\n- circle: 绘制圆形框\n- text: 添加文字注释\n- arrow: 绘制箭头\n- resolution_reduction: 分辨率下降特效\n- grayscale: 黑白特效\n- crop_region: 截取指定区域\n\n参数:\n- imagePath (字符串, 必需): 图片文件的完整路径\n- edits (数组, 必需): 编辑操作列表，每个元素包含：\n  - editType (字符串, 必需): 编辑类型\n  - x (浮点数, 特定类型必需): X坐标比例 (0.0-1.0)\n  - y (浮点数, 特定类型必需): Y坐标比例 (0.0-1.0)\n  - width (浮点数, rectangle/crop_region时必需): 宽度比例\n  - height (浮点数, rectangle/crop_region时必需): 高度比例\n  - radius (浮点数, circle时必需): 半径比例\n  - text (字符串, text时必需): 文字内容\n  - scaleRatio (浮点数, resolution_reduction时必需): 分辨率缩放比例 (0.1-1.0)\n  - color (字符串, 可选): 颜色名称或16进制值\n  - fontSize (浮点数, 可选): 字体大小比例 (0.0-1.0)\n  - strokeWidth (浮点数, 可选): 线条宽度比例 (0.0-1.0)\n  - textPosition (字符串, 可选): 文字位置\n  - arrowEndX (浮点数, arrow时必需): 箭头终点X坐标\n  - arrowEndY (浮点数, arrow时必需): 箭头终点Y坐标\n- outputPath (字符串, 可选): 输出文件路径\n\n**极其重要的操作顺序原则：**\n1. **先应用特效，后绘制元素**：分辨率下降、黑白特效应该在最前面\n2. **crop_region必须放在最后**：因为截取会改变图片尺寸，会导致之前的坐标参数失效\n3. **推荐顺序**：resolution_reduction → grayscale → rectangle/circle/text/arrow → crop_region\n\n**重要提示**：\n1. fontSize和strokeWidth参数传递0.0-1.0比例值\n2. 操作按顺序执行，每个步骤的结果传递给下一步\n3. 输出文件遵循严格命名规则\n\n调用格式:\n<<<[TOOL_REQUEST]>>>\ntool_name:「始」MediaShot「末」,\ncommand:「始」BatchEditImage「末」,\nimagePath:「始」/path/to/image.jpg「末」,\nedits:「始」[{\"editType\":\"grayscale\"},{\"editType\":\"text\",\"x\":0.5,\"y\":0.5,\"text\":\"标注\",\"color\":\"white\",\"fontSize\":0.05},{\"editType\":\"crop_region\",\"x\":0.1,\"y\":0.1,\"width\":0.8,\"height\":0.8}]「末」\n<<<[END_TOOL_REQUEST]>>>"
      },
      {
        "commandIdentifier": "CombinedCapture",
        "description": "组合功能：先从视频截图，然后立即对截图进行编辑。\n\n**支持的编辑类型:**\n- rectangle: 绘制矩形框\n- circle: 绘制圆形框\n- text: 添加文字注释\n- arrow: 绘制箭头\n- resolution_reduction: 分辨率下降特效\n- grayscale: 黑白特效\n- crop_region: 截取指定区域\n\n参数:\n- videoPath (字符串, 必需): 视频文件的完整路径\n- timestampMs (整数, 必需): 截图的时间点（毫秒）\n- editType (字符串, 必需): 编辑类型\n- x (浮点数, 特定类型必需): 编辑区域X坐标比例 (0.0-1.0)\n- y (浮点数, 特定类型必需): 编辑区域Y坐标比例 (0.0-1.0)\n- width (浮点数, rectangle/crop_region时必需): 宽度比例 (0.0-1.0)\n- height (浮点数, rectangle/crop_region时必需): 高度比例 (0.0-1.0)\n- radius (浮点数, circle时必需): 半径比例 (0.0-1.0)\n- text (字符串, text时必需): 要添加的文字\n- scaleRatio (浮点数, resolution_reduction时必需): 分辨率缩放比例 (0.1-1.0)\n- color (字符串, 可选): 颜色名称或16进制值，默认red\n- fontSize (浮点数, 可选): 字体大小比例 (0.0-1.0)\n- strokeWidth (浮点数, 可选): 线条宽度比例 (0.0-1.0)\n- textPosition (字符串, 可选): 文字位置，默认center\n- arrowEndX (浮点数, arrow时必需): 箭头终点X坐标比例\n- arrowEndY (浮点数, arrow时必需): 箭头终点Y坐标比例\n- outputPath (字符串, 可选): 输出文件路径\n\n**重要提示**：\n1. fontSize和strokeWidth参数传递0.0-1.0比例值\n2. 输出文件遵循严格命名规则\n\n调用格式:\n<<<[TOOL_REQUEST]>>>\ntool_name:「始」MediaShot「末」,\ncommand:「始」CombinedCapture「末」,\nvideoPath:「始」/path/to/video.mp4「末」,\ntimestampMs:「始」5000「末」,\neditType:「始」text「末」,\nx:「始」0.5「末」,\ny:「始」0.3「末」,\ntext:「始」重要场景「末」,\ncolor:「始」#FFFF00「末」,\nfontSize:「始」0.06「末」\n<<<[END_TOOL_REQUEST]>>>"
      }
    ]
  }
}